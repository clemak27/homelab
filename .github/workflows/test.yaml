---
name: test
on:
  - pull_request
jobs:
  docker-compose:
    runs-on: ubuntu-latest
    env:
      DEPLOY_TEST: true
    steps:
      - name: Checkout
        uses: actions/checkout@v2.0.0
      - name: Test docker-compose file
        run: cd services && ./deploy.sh
  ignition:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v2.0.0
      - name: Nix setup
        uses: cachix/install-nix-action@v16
      - name: Run ignition test
        run: nix shell nixpkgs#gnumake nixpkgs#butane -c make test
