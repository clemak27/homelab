version: '3.8'

services:
  pihole:
    image: ${PIHOLE_SERVICE_IMAGE:?}:${PIHOLE_SERVICE_VERSION:?}
    container_name: ${PIHOLE_SERVICE_NAME:?}
    volumes:
      - "${DOCKER_DATA}/${PIHOLE_SERVICE_NAME}/etc-pihole/:/etc/pihole/"
      - "${DOCKER_DATA}/${PIHOLE_SERVICE_NAME}/etc-dnsmasq.d/:/etc/dnsmasq.d/"
      - "${DOCKER_DATA}/${PIHOLE_SERVICE_NAME}/lighttpd.external.conf:/etc/lighttpd/external.conf"
    security_opt:
      - "label:disable"
    network_mode: 
      host
    environment:
      TZ: "Europe/Vienna"
      WEBPASSWORD: "${PIHOLE_PW}"
    cap_add:
      - NET_ADMIN
  pihole-exporter:
    image: ${PIHOLE_EXPORTER_SERVICE_IMAGE:?}:${PIHOLE_EXPORTER_SERVICE_VERSION:?}
    container_name: ${PIHOLE_EXPORTER_SERVICE_NAME:?}
    networks:
      - private
    ports:
      - "${PIHOLE_EXPORTER_SERVICE_PORT}:${PIHOLE_EXPORTER_SERVICE_PORT}"
    environment:
      PIHOLE_HOSTNAME: "192.168.178.100"
      PIHOLE_PASSWORD: "${PIHOLE_PW}"
      PIHOLE_PORT: "${PIHOLE_EXPORTER_SERVICE_PORT}"
      PORT: "9617"
